# kapsule-base profile - Always applied to all Kapsule containers
#
# /run/user/$UID will be symlinked or bind-mounted to
# /.kapsule/host/run/user/$UID inside the container

description: Kapsule base profile - privileged container with host integration
config:

  # In a future version, we might investigate what
  # we can do with unprivileged containers.
  security.privileged: "true"
  security.nesting: "true"
  
  # Use host networking
  raw.lxc: |
    lxc.net.0.type=none

devices:
  # X11 socket passthrough, not user-specific
  x11:
    type: disk
    source: /tmp/.X11-unix
    path: /tmp/.X11-unix


  gpu:
    type: gpu
  
  # mount the host filesystem
  hostfs:
    type: disk
    source: /
    path: /.kapsule/host
    propagation: rslave
    recursive: true
    shift: false