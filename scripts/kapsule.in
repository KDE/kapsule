#!/bin/sh
# Kapsule CLI wrapper script
# Generated by CMake build system
# SPDX-License-Identifier: GPL-3.0-or-later
# SPDX-FileCopyrightText: 2024-2026 KDE Community

# Resolve paths relative to script location
PREFIX_DIR="$(dirname "$0")/.."
KAPSULE_PYTHON_PATH="$PREFIX_DIR/share/kapsule/python"
KAPSULE_VENDOR_PATH="$PREFIX_DIR/share/kapsule/vendor"

# Build PYTHONPATH: vendor first (so vendored deps take precedence), then kapsule
if [ -n "$PYTHONPATH" ]; then
    export PYTHONPATH="${KAPSULE_VENDOR_PATH}:${KAPSULE_PYTHON_PATH}:${PYTHONPATH}"
else
    export PYTHONPATH="${KAPSULE_VENDOR_PATH}:${KAPSULE_PYTHON_PATH}"
fi

# Cache bytecode in user's cache directory (since /usr is read-only)
export PYTHONPYCACHEPREFIX="${XDG_CACHE_HOME:-$HOME/.cache}/kapsule/pycache"

# Set program name for CLI help text
export KAPSULE_PROG_NAME="${0##*/}"

exec @PYTHON_EXECUTABLE@ -m kapsule.main "$@"
